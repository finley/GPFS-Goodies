#
# 2012.10.27 Brian Elliott Finley <bfinley@us.ibm.com>
# - created
#

#
#   Part of the GPFS Goodies bundle:
#
#       http://pokgsa.ibm.com/gsa/projects/g/gpfs_goodies/
#

#
# A very quick and brief HOWTO use the tools in this directory.
#

Step 0:

    Execute multipath.conf-creator on the machine where you have
    SMclient installed.


Step 1:
    
    mmshutdown 

    #
    # Use your own judgement, but if you're not sure, shutdown the
    # filesystem before changing configuration files on your NSD
    # servers.
    #


Step 2:
    
    Run command to copy files out to each NSD server.

        cp /var/mmfs/etc/nsddevices
        /etc/udev/rules.d/70-ibm-storage.rules
        /etc/modprobe.d/scsi_dh_alua.conf


    # Set your node names
    MY_NODE=nsd1

    scp /usr/share/gpfs_goodies/var/mmfs/etc/nsddevices out to /var/mmfs/etc/nsddevices on
    each NSD server.


Step 2:

    Copy ./etc/udev/rules.d/70-ibm-storage.rules out to
    /etc/udev/rules.d/70-ibm-storage.rules on each NSD server.


Step 3:



Step 4:

    Do what the output from multipath.conf-creator says. ;-)


Step 5:

    Copy ./etc/modprobe.d/scsi_dh_alua.conf out to
    /etc/modprobe.d/scsi_dh_alua.conf on each NSD server, then re-build
    the initrd.  On RedHat 6, this is done via "dracut" command with
    something like this:

    #
    # Backup original initrd
    cp /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r).img.orig

    #
    # Create a new one
    dracut -f /boot/initramfs-$(uname -r).img $(uname -r)


